$(function(){function e(t){for(var e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++){var o=e[n].split("=");if(o[0]==t)return o[1]}return!1}var n="http://www.zpffz.com",o=$("#msg-puop")[0],r=$(".get-code"),i=$("#phone-number")[0],s=$("#vef-code")[0],t=$(".btn-sbumit"),a=$(".modal"),c=$(".modal").find(".close"),u=$("#confirm");function f(){this.checkInfo=[],this.wran=[]}f.prototype.strategies={noEmpty:function(t,e){return""!==t||e},isMobile:function(t,e){return!!/^1[3456789]\d{9}$/.test(t)||e}},f.prototype.add=function(r,i,t){var s=this;this.wran.push(i),t.forEach(function(o){s.checkInfo.push(function(){var t=o.strategy.split(":"),e=t.shift();t.unshift(r.value),t.push(o.error);var n=s.strategies[e].apply(s,t);return console.log("msg",n),!0!==n&&l.show(i,n),n})})};var h={isNot:!(f.prototype.check=function(){var t=!0;this.wran.forEach(function(t){t.innerText=""});for(var e=0;e<this.checkInfo.length;e++)if(!0!==this.checkInfo[e]())return t=!1;return t}),countTimer:0,countDown:function(t){this.isNot=!0,this.countTimer=setInterval(function(){--t<=0?this.clearCountTimer():r.text("重新获取("+t+")s")},1e3)},clearCountTimer:function(){this.isNot=!1,clearInterval(this.countTimer),r.text("获取验证码")}},l={timer:0,show:function(t,e){$(t).text(e).fadeIn(200),this.hide(t,"")},hide:function(t,e){this.timer&&clearInterval(this.timer),this.timer=setInterval(function(){$(t).fadeOut(200,function(){$(this).text(e)})},3e3)}};r.on("click",function(){var t;h.isNot||(t={mobile:i.value,originUrl:e("originUrl")},$.ajax({type:"post",url:n+"/api/dq/bjph/sendCode",data:t,dataType:"dataType",success:function(t){var e;console.log("res",t),200===t.code?(h.countDown(60),e=t.data,$("#x").text(e.X+"元"),$("#y").text(e.Y+"元")):l.show(o,t.msg)},error:function(t){var e=JSON.parse(t.responseText);l.show(o,e.msg)}}))});var p=new f;t.click(function(){p.add(i,o,[{strategy:"noEmpty",error:"请输入手机号"},{strategy:"isMobile",error:"手机号码有误，请重新输入"}]),p.add(s,o,[{strategy:"noEmpty",error:"请输入验证码"}]),p.check()&&a.fadeIn(300)}),u.on("click",function(){var t={mobile:i.value,validCode:s.value,originUrl:e("originUrl")};a.fadeOut(300),$.ajax({type:"post",url:n+"/api/dq/bjph/saveOrders",data:t,dataType:"dataType",success:function(t){console.log("res",t),l.show(o,t.msg)},error:function(t){var e=JSON.parse(t.responseText);l.show(o,e.msg)}})}),c.on("click",function(){a.fadeOut(300)})});